<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>The Projection Flipbook: Visualizing the Map Projection Distortion in Context</title>
  <meta name="description" content="Beyond the Peel: Visualizing the Map Projection Distortion in Context" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./css/01-settings.css" />
  <link rel="stylesheet" href="./css/02-normalize.css" />
  <link rel="stylesheet" href="./css/03-reset.css" />
  <link rel="stylesheet" href="./css/04-general.css" />
  <link rel="stylesheet" href="./css/07-section-styling.css" />
  <link rel="stylesheet" href="./css/08-scrolly.css" />
  <link rel="stylesheet" href="./css/08-scrolly-side.css" />
  <link rel="stylesheet" href="./css/style.css" />
</head>

<!-- <script src="https://d3js.org/d3.v7.min.js" charset="utf-8"></script> -->
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-geo@1"></script>
<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
<script src="https://unpkg.com/d3-geo-polygon@1"></script>
<script src="https://d3js.org/topojson.v2.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-color@3"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-interpolate@3"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-ease@3"></script>
<script src="scripts/base-flipbook-functions.js"></script>
<script src="scripts/dot-density.js"></script>
<script src="scripts/choropleth.js"></script>
</html>
<script>

// all data to be visualized
var abortion = {}; 
var covidDeaths = {}; 
var covidCases = {}; 
var covidCasesDensity = {}; 
var covidDeathsDensity = {}; 

// set and pulled from the scrollytelling
var currentData;
var vizType;

var rawProjection0;
var rawProjection1;
var rawProjection2;
var projectionRotations;
var countries 

d3.queue()
  .defer(d3.json, "data/countries-110m.json")
  .defer(d3.csv, "data/abortion-access_clean.csv", function (d) { abortion[d.id] =  +d.value; })
  .defer(d3.csv, "data/covid-deaths.csv", function (d) { covidDeaths[d.id] =  +d.value; })
  .defer(d3.csv, "data/covid-cases.csv", function (d) { covidCases[d.id] =  +d.value; })
  .defer(d3.csv, "data/covid-deaths-per-100000.csv", function (d) { covidDeathsDensity[d.id] =  +d.value; })
  .defer(d3.csv, "data/covid-cases-per-100000.csv", function (d) { covidCasesDensity[d.id] =  +d.value; })
  .await(ready);
function ready(error, countries110m) {

    // Define Map Boundaries
  countries = topojson.feature(countries110m, countries110m.objects.countries);
  countries.features = countries.features.filter(feature => feature.properties.name !== 'Fiji'); // Remove because of problems with Clipping
  let features = countries.features;
  let countrymesh = topojson.mesh(countries110m, countries110m.objects.countries, (a, b) => a !== b)
  let graticule = d3.geoGraticule10()
  let outline = ({ type: "Sphere" })
  console.log(countries); 

    console.log(abortion)

}

</script>
